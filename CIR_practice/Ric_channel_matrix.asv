function A = Ric_channel_matrix(numTx, numRx, K_dB, L)
% Rician channel matrix
% Input : K_dB = K factor[dB]
% Output: H = 3-D Channel Matrix
K = 10^(K_dB/10);
A = zeros(numTx, numRx, L);
for l=1:L
    for i=1:numTx
        for j=1:numRx
            A(i, j, l) = sqrt(K/(K+1)) + sqrt(1/(K+1))*Ray_model(L);
        end
    end
end
K = 10^(K_dB/10);
H = sqrt(K/(K+1)) + sqrt(1/(K+1))*Ray_model(L);
H = (randn(1,L)+1i*randn(1,L))/sqrt(2);